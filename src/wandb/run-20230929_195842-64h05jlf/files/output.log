/Users/anuragkumar/opt/miniconda3/envs/rlhf-debug/lib/python3.9/site-packages/torch/functional.py:572: UserWarning: stft will soon require the return_complex parameter be given for real inputs, and will further require that return_complex=True in a future PyTorch release. (Triggered internally at  ../aten/src/ATen/native/SpectralOps.cpp:659.)
  return _VF.stft(input, n_fft, hop_length, win_length, window,  # type: ignore[attr-defined]
/Users/anuragkumar/opt/miniconda3/envs/rlhf-debug/lib/python3.9/site-packages/torch/functional.py:647: UserWarning: istft will require a complex-valued input tensor in a future PyTorch release. Matching the output from stft with return_complex=True.  (Triggered internally at  ../aten/src/ATen/native/SpectralOps.cpp:811.)
  return _VF.istft(input, n_fft, hop_length, win_length, window, center,  # type: ignore[attr-defined]
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
est_aud:torch.Size([5, 2, 200])
Generator loop step:1
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
est_aud:torch.Size([5, 2, 200])
Generator loop step:2
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
est_aud:torch.Size([5, 2, 200])
Generator loop step:3
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
est_aud:torch.Size([5, 2, 200])
Generator loop step:4
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
torch.Size([2, 1, 1, 201]) torch.Size([2, 1, 1, 201])
torch.Size([2, 1, 201, 2])
torch.Size([2, 3, 201, 2]) torch.Size([2, 200])
est_aud:torch.Size([5, 2, 200])
Generator loop step:5
est_real:torch.Size([5, 2, 1, 5, 201])
est_imag:torch.Size([5, 2, 5, 1, 201])
est_mag:torch.Size([5, 2, 1, 5, 201])
clean_real:torch.Size([2, 1, 201, 5])
clean_imag:torch.Size([2, 1, 201, 5])
clean_mag:torch.Size([2, 1, 201, 5])
est_audio:torch.Size([5, 2, 0, 5])
clean:torch.Size([2, 2000])
one_labels:torch.Size([2])
/Users/anuragkumar/Anurag/CMGAN/src/train.py:241: UserWarning: Using a target size (torch.Size([2, 1, 5, 201])) that is different to the input size (torch.Size([2, 5, 1, 201])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  ) + F.mse_loss(generator_outputs["est_imag"][k, ...], generator_outputs["clean_imag"].permute(0, 1, 3, 2))
Traceback (most recent call last):
  File "/Users/anuragkumar/Anurag/CMGAN/src/train.py", line 766, in <module>
    main(None, world_size, args)
  File "/Users/anuragkumar/Anurag/CMGAN/src/train.py", line 757, in main
    trainer.train2()
  File "/Users/anuragkumar/Anurag/CMGAN/src/train.py", line 668, in train2
    for loss, disc_loss, pesq in self.train_step2(batch):
  File "/Users/anuragkumar/Anurag/CMGAN/src/train.py", line 385, in train_step2
    loss = self.calculate_generator_loss2(outputs, samples=self.samples)
  File "/Users/anuragkumar/Anurag/CMGAN/src/train.py", line 246, in calculate_generator_loss2
    torch.abs(generator_outputs["est_audio"][k, :] - generator_outputs["clean"][:, :est_audio_len])
RuntimeError: The size of tensor a (0) must match the size of tensor b (2) at non-singleton dimension 1